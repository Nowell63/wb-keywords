# WB Keyword Tracker (демо)

Готовая страница под скрин: сверху поле **Добавить API**, ниже выбор товара из вашего WB-аккаунта, затем список ключевых слов. Таблица отображает позиции по дням.

> Важно: WB **не предоставляет** официального API для позиций по поисковым запросам. В демо данные **моковые**. Подключите ваш источник (собственный парсер/агрегатор/провайдер).

## Быстрый старт
```bash
npm i
npm run dev
# откройте http://localhost:3000
```

## Как это работает
- `app/api/wb/cards/route.ts` — серверный прокси в WB Content API (`/content/v2/get/cards/list`) по вашему токену.
- `app/api/positions/route.ts` — заглушка, сейчас генерирует случайные позиции на 10 дней.

## Где включить настоящие позиции
В `app/api/positions/route.ts`:
1. На входе у вас уже есть `nmID` и `keywords`.
2. Внутри замените генератор на вызов вашей функции `getPositions({ nmID, keywords, date: today })`,
   которая обращается к вашему источнику данных (например, вашему API).
3. Возвращайте формат:
```ts
type PositionPoint = { date: string; position: number | null };
type KeywordRow = { keyword: string; history: PositionPoint[] };
```
История по каждой дате заполняется на вашей стороне.

## Ежедневная автопроверка (cron)
- На Vercel добавьте `vercel.json`:
```json
{
  "crons": [
    { "path": "/api/positions", "schedule": "0 6 * * *" }
  ]
}
```
- Реализуйте сохранение конфигураций (токен, nmID, keywords) в БД (например, SQLite/Prisma) и отдельный `app/api/cron/run/route.ts`, который обойдёт все конфиги и обновит историю.
- На UI история подхватывается при открытии страницы.

## Безопасность
- Токен WB никогда не храните в клиенте на проде. В демо он кладётся в localStorage для простоты. На проде:
  - создайте серверный сейф (KV/DB) и прокидывайте ID конфигурации вместо полного токена.
  - отделите токены read-only (карточки) и write (если будете менять цены/остатки).

## Кастомизация под ваш скрин
- Правьте стили в `app/globals.css`.
- В шапке уже есть блок **Добавить API** и кнопка **Загрузить товары**.
- Таблица строится динамически: строки = ключи, колонки = уникальные даты в истории.
